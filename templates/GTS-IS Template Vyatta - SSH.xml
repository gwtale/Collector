<?xml version="1.0" ?>
<zabbix_export>
	<version>3.2</version>
	<date>2016-01-01T01:01:01Z</date>
	<groups>
		<group>
			<name>Templates</name>
		</group>
	</groups>
	<templates>
		<template>
			<template>GTS-IS Template Vyatta - SSH</template>
			<name>GTS-IS Template Vyatta - SSH</name>
			<description/>
			<groups>
				<group>
					<name>Templates</name>
				</group>
			</groups>
			<applications>
				<application>
					<name>Configuration</name>
				</application>
				<application>
					<name>General</name>
				</application>
				<application>
					<name>GRE</name>
				</application>
				<application>
					<name>Memory</name>
				</application>
				<application>
					<name>Network</name>
				</application>
				<application>
					<name>OS</name>
				</application>
				<application>
					<name>Performance</name>
				</application>
				<application>
					<name>Services</name>
				</application>
				<application>
					<name>VPN</name>
				</application>
				<application>
					<name>VRRP</name>
				</application>
				<application>
					<name>Zabbix Agent</name>
				</application>
			</applications>
			<items>
				<item>
					<name>Web Interface is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.tcp.service[tcp,,80]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>0</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>WebProxy service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.tcp.service[tcp,,3128]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>net.udp.listen is supported since Zabbix agent version 1.8.4.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>DHCP service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.udp.listen[67]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>net.udp.listen is supported since Zabbix agent version 1.8.4.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>UDP NTP service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.udp.listen[123]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>net.udp.listen is supported since Zabbix agent version 1.8.4.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>SNMP service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.udp.listen[161]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>net.udp.listen is supported since Zabbix agent version 1.8.4.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>OpenVPN port is LISTEN</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.udp.listen[1194]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>L2TP VPN service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>net.udp.listen[1701]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Memory usage of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.mem[dhcpd3]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Memory usage of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.mem[netplugd]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Memory usage of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.mem[openvpn]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Memory usage of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.mem[snmpd]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Memory usage of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.mem[squid3]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Number of processes of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>proc.num[netplugd]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>This Monitoring is supported Vyatta 6.5 R1 Zabbix agent version 2.0.5.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>OpenVPN service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>process_status[openvpn]</key>
					<delay>120</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>OLD KEY: net.udp.listen[1194] - Key was replaced because command &quot;netstat&quot; still shows the port as LISTEN even if closed in firewall rules.
Using process method instead (custom, inside zabbix_agent.conf), which monitors the openvpn daemon.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap>
						<name>Service state</name>
					</valuemap>
					<logtimefmt/>
				</item>
				<item>
					<name>IPSec service is running</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>process_status[pluto]</key>
					<delay>60</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>OLD KEY: net.udp.listen[1194] - Key was replaced because command &quot;netstat&quot; still shows the port as LISTEN even if closed in firewall rules.
Using process method instead (custom, inside zabbix_agent.conf), which monitors the openvpn daemon.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Services</name>
						</application>
					</applications>
					<valuemap>
						<name>Service state</name>
					</valuemap>
					<logtimefmt/>
				</item>
				<item>
					<name>Contents of config.boot</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>read[/config/config.boot]</key>
					<delay>28800</delay>
					<history>90</history>
					<trends>0</trends>
					<status>1</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description>Zabbix cut the results if the returned information is too large, hence we disabled this item.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Configuration</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Conntrack count</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[conntrack_count]</key>
					<delay>120</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units>entries</units>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>cat /proc/sys/net/ipv4/netfilter/ip_conntrack_count</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Network</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Conntrack MAX</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[conntrack_max]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units>entries</units>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>cat /proc/sys/net/ipv4/netfilter/ip_conntrack_max</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Network</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Ping IP</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[ping_ip]</key>
					<delay>60</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>if fping -u 8.8.8.8 &gt;&amp; /dev/null ;then echo 0; else echo 2; fi</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Network</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>VRRP process status</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[process_status.keepalived]</key>
					<delay>60</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>if pgrep keepalived &gt; /dev/null; then echo 1; else echo 0; fi</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>VRRP</name>
						</application>
					</applications>
					<valuemap>
						<name>Service state</name>
					</valuemap>
					<logtimefmt/>
				</item>
				<item>
					<name>Routing table</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[routing_table]</key>
					<delay>86400</delay>
					<history>90</history>
					<trends>0</trends>
					<status>0</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show ip route</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Configuration</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Vyatta version</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[show_version]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>0</trends>
					<status>0</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show version|grep Version| awk '{ print $2 }'</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>16</inventory_link>
					<applications>
						<application>
							<name>OS</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>VRRP last transition (bond0)</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[vrrp_lasttransition.bond0]</key>
					<delay>600</delay>
					<history>90</history>
					<trends>0</trends>
					<status>0</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show vrrp |grep &quot;bond0 &quot; | awk '{ print $6 }'</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description>IMPORTANT: Despite Zabbix can read VRRP status per interface (bond0, bond1, etc) and have items automatically created via prototypes, we are using &quot;hard coded&quot; interface for 2 reasons:
1. VRRP should migrate ALL interfaces in case of failure either in one interface or in Vyatta entirely, so all interfaces would have the same status (master or slave);
2. Trigger prototypes can only access and use information from item prototypes within the same discovery rule OR use information from a normal item (not prototype). By using this setup it is possible to create, for instance, a trigger prototype that will read a condition from a item prototype AND a value from another item as condition.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>VRRP</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>VRRP status (bond0)</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[vrrp_status.bond0]</key>
					<delay>60</delay>
					<history>90</history>
					<trends>0</trends>
					<status>0</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show vrrp |grep bond0 | awk '{ print $3 }'</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description>IMPORTANT: Despite Zabbix can read VRRP status per interface (bond0, bond1, etc) and have items automatically created via prototypes, we are using &quot;hard coded&quot; interface for 2 reasons:
1. VRRP should migrate ALL interfaces in case of failure either in one interface or in Vyatta entirely, so all interfaces would have the same status (master or slave);
2. Trigger prototypes can only access and use information from item prototypes within the same discovery rule OR use information from a normal item (not prototype). By using this setup it is possible to create, for instance, a trigger prototype that will read a condition from a item prototype AND a value from another item as condition.</description>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>VRRP</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Zones</name>
					<type>13</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>ssh.run[zones]</key>
					<delay>86400</delay>
					<history>90</history>
					<trends>0</trends>
					<status>0</status>
					<value_type>4</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show zone policy</params>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Configuration</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Checksum of $1</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>vfs.file.cksum[/config/config.boot]</key>
					<delay>3600</delay>
					<history>7</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>General</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>IPSec routing table threshold</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>xfrm4_gc_thresh</key>
					<delay>600</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Network</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
				<item>
					<name>Xfrm OutBundleGenError (IPSec related)</name>
					<type>0</type>
					<snmp_community/>
					<multiplier>0</multiplier>
					<snmp_oid/>
					<key>xfrm_stat[XfrmOutBundleGenError]</key>
					<delay>60</delay>
					<history>90</history>
					<trends>365</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<delta>0</delta>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<formula>1</formula>
					<delay_flex/>
					<params/>
					<ipmi_sensor/>
					<data_type>0</data_type>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>Network</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
				</item>
			</items>
			<discovery_rules>
				<discovery_rule>
					<name>GRE discovery</name>
					<type>13</type>
					<snmp_community/>
					<snmp_oid/>
					<key>ssh.run[discovery.gre_tunnels]</key>
					<delay>60</delay>
					<status>0</status>
					<allowed_hosts/>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<delay_flex/>
					<params>#!/bin/vbash
tunnels=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel|grep 'tun'|awk '{print $1}'`
first=1
echo &quot;{&quot;
echo &quot;\&quot;data\&quot;:[&quot;
for tunnel in $tunnels
do
      if [[ $first = 0 ]] ; then echo &quot;,&quot; ; fi
      first=0
      peer=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel $tunnel |grep peer|awk '{ print $4 }'`
      echo &quot;    {\&quot;{#TUN_INT}\&quot;:\&quot;$tunnel\&quot;,\&quot;{#GRE_PEER}\&quot;:\&quot;$peer\&quot;}&quot;
done
echo &quot;]&quot;
echo &quot;}&quot;</params>
					<ipmi_sensor/>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<filter>
						<evaltype>0</evaltype>
						<formula/>
						<conditions/>
					</filter>
					<lifetime>0</lifetime>
					<description/>
					<item_prototypes>
						<item_prototype>
							<name>GRE {#TUN_INT} Local IP</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[gre_local.{#TUN_INT}]</key>
							<delay>600</delay>
							<history>90</history>
							<trends>0</trends>
							<status>0</status>
							<value_type>4</value_type>
							<allowed_hosts/>
							<units/>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel {#TUN_INT} |grep peer|awk '{ print $2 }'</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>GRE</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
						<item_prototype>
							<name>GRE {#TUN_INT} Peer IP</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[gre_peer.{#TUN_INT}]</key>
							<delay>600</delay>
							<history>90</history>
							<trends>0</trends>
							<status>0</status>
							<value_type>4</value_type>
							<allowed_hosts/>
							<units/>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel {#TUN_INT} |grep peer|awk '{ print $4 }'</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>GRE</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
						<item_prototype>
							<name>GRE {#TUN_INT} Peer Status</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[gre_peer_alive.{#TUN_INT}]</key>
							<delay>60</delay>
							<history>90</history>
							<trends>365</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units/>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>peer=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel {#TUN_INT} |grep peer|awk '{ print $4 }'`;if fping -u $peer &gt;&amp; /dev/null ;then echo 1; else echo 0; fi</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>GRE</name>
								</application>
							</applications>
							<valuemap>
								<name>Host availability</name>
							</valuemap>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
						<item_prototype>
							<name>GRE {#TUN_INT} Peer Latency</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[gre_peer_latency.{#TUN_INT}]</key>
							<delay>60</delay>
							<history>90</history>
							<trends>365</trends>
							<status>0</status>
							<value_type>0</value_type>
							<allowed_hosts/>
							<units>ms</units>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>peer=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show interfaces tunnel {#TUN_INT} |grep peer|awk '{ print $4 }'`;if fping -u $peer &gt;&amp; /dev/null ;then fping -e $peer|awk '{print substr($4,2); }'; else echo 0; fi</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>GRE</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
					</item_prototypes>
					<trigger_prototypes>
						<trigger_prototype>
							<expression>{GTS-IS Template Vyatta - SSH:ssh.run[gre_peer_alive.{#TUN_INT}].last(#5)}=0</expression>
							<recovery_mode>0</recovery_mode>
							<recovery_expression/>
							<name>GRE peer {#GRE_PEER} is unreachable</name>
							<correlation_mode>0</correlation_mode>
							<correlation_tag/>
							<url/>
							<status>0</status>
							<priority>4</priority>
							<description>GRE peer is not responding to ICMP (last 5 verifications)</description>
							<type>0</type>
							<manual_close>0</manual_close>
							<dependencies/>
							<tags/>
						</trigger_prototype>
						<trigger_prototype>
							<expression>{GTS-IS Template Vyatta - SSH:ssh.run[gre_peer_latency.{#TUN_INT}].last(#5)}&gt;50</expression>
							<recovery_mode>0</recovery_mode>
							<recovery_expression/>
							<name>GRE peer {#GRE_PEER} latency too high</name>
							<correlation_mode>0</correlation_mode>
							<correlation_tag/>
							<url/>
							<status>0</status>
							<priority>2</priority>
							<description>GRE peer have latency &gt; 50ms in the last 5 verifications</description>
							<type>0</type>
							<manual_close>0</manual_close>
							<dependencies/>
							<tags/>
						</trigger_prototype>
					</trigger_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>GRE {#TUN_INT} Peer Latency ({#GRE_PEER})</name>
							<width>900</width>
							<height>200</height>
							<yaxismin>0.0000</yaxismin>
							<yaxismax>100.0000</yaxismax>
							<show_work_period>1</show_work_period>
							<show_triggers>1</show_triggers>
							<type>0</type>
							<show_legend>1</show_legend>
							<show_3d>0</show_3d>
							<percent_left>0.0000</percent_left>
							<percent_right>0.0000</percent_right>
							<ymin_type_1>0</ymin_type_1>
							<ymax_type_1>0</ymax_type_1>
							<ymin_item_1>0</ymin_item_1>
							<ymax_item_1>0</ymax_item_1>
							<graph_items>
								<graph_item>
									<sortorder>0</sortorder>
									<drawtype>5</drawtype>
									<color>00EE00</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>2</calc_fnc>
									<type>0</type>
									<item>
										<host>GTS-IS Template Vyatta - SSH</host>
										<key>ssh.run[gre_peer_latency.{#TUN_INT}]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<drawtype>4</drawtype>
									<color>FFFF66</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>2</calc_fnc>
									<type>0</type>
									<item>
										<host>GTS-IS Template Vyatta - SSH</host>
										<key>ssh.run[gre_peer_alive.{#TUN_INT}]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<host_prototypes/>
				</discovery_rule>
				<discovery_rule>
					<name>VPN discovery</name>
					<type>13</type>
					<snmp_community/>
					<snmp_oid/>
					<key>ssh.run[discovery.vpn_peers]</key>
					<delay>60</delay>
					<status>0</status>
					<allowed_hosts/>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<delay_flex/>
					<params>#!/bin/vbash
peers=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show vpn ipsec sa detail |grep 'Peer IP'|awk '{print $3}'`
first=1
echo &quot;{&quot;
echo &quot;\&quot;data\&quot;:[&quot;
for peer in $peers
do
    tunnels=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show vpn ipsec sa peer $peer |head -n -2| grep '  up\|  down'|awk '{print $1}'`
    for tunnel in $tunnels
    do
      if [[ $first = 0 ]] ; then echo &quot;,&quot; ; fi
      first=0
      echo &quot;    {\&quot;{#VPN_PEER}\&quot;:\&quot;$peer\&quot;,\&quot;{#VPN_TUNNEL}\&quot;:\&quot;$tunnel\&quot;}&quot;
    done
done
echo &quot;]&quot;
echo &quot;}&quot;</params>
					<ipmi_sensor/>
					<authtype>0</authtype>
					<username>{$SSH_ID}</username>
					<password>{$SSH_PASSWORD}</password>
					<publickey/>
					<privatekey/>
					<port/>
					<filter>
						<evaltype>0</evaltype>
						<formula/>
						<conditions/>
					</filter>
					<lifetime>0</lifetime>
					<description/>
					<item_prototypes>
						<item_prototype>
							<name>VPN peer {#VPN_PEER} tunnel {#VPN_TUNNELS} - total bytes IN</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[vpn_tunnel_bytesin.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
							<delay>60</delay>
							<history>90</history>
							<trends>365</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>bytes</units>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>result=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show vpn ipsec sa statistics peer {#VPN_PEER} tunnel {#VPN_TUNNEL} |tail -n 4|grep in|awk '{print $5}'`;if [ &quot;$result&quot; == &quot;n/a&quot; ] ;then echo 0; else echo $result; fi</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>VPN</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
						<item_prototype>
							<name>VPN peer {#VPN_PEER} tunnel {#VPN_TUNNEL} - total bytes OUT</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[vpn_tunnel_bytesout.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
							<delay>60</delay>
							<history>90</history>
							<trends>365</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>bytes</units>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>result=`/opt/vyatta/bin/vyatta-op-cmd-wrapper show vpn ipsec sa statistics peer {#VPN_PEER} tunnel {#VPN_TUNNEL} |tail -n 4|grep out|awk '{print $5}'`;if [ &quot;$result&quot; == &quot;n/a&quot; ] ;then echo 0; else echo $result; fi</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>VPN</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
						<item_prototype>
							<name>VPN peer {#VPN_PEER} tunnel {#VPN_TUNNEL} status</name>
							<type>13</type>
							<snmp_community/>
							<multiplier>0</multiplier>
							<snmp_oid/>
							<key>ssh.run[vpn_tunnel_status.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
							<delay>60</delay>
							<history>90</history>
							<trends>365</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units/>
							<delta>0</delta>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<formula>1</formula>
							<delay_flex/>
							<params>TUNSTATUS=&quot;$(/opt/vyatta/bin/vyatta-op-cmd-wrapper show vpn ipsec sa peer {#VPN_PEER} tunnel {#VPN_TUNNEL} |tail -n 3|head -n 1|awk '{ print $2 }')&quot; &amp;&amp; if [ &quot;$TUNSTATUS&quot; == &quot;up&quot; ]; then echo 1; else echo 0; fi</params>
							<ipmi_sensor/>
							<data_type>0</data_type>
							<authtype>0</authtype>
							<username>{$SSH_ID}</username>
							<password>{$SSH_PASSWORD}</password>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>VPN</name>
								</application>
							</applications>
							<valuemap>
								<name>Service state</name>
							</valuemap>
							<logtimefmt/>
							<application_prototypes/>
						</item_prototype>
					</item_prototypes>
					<trigger_prototypes>
						<trigger_prototype>
							<expression>{GTS-IS Template Vyatta - SSH:ssh.run[vpn_tunnel_status.{#VPN_PEER}:{#VPN_TUNNEL}].last(#5)}=0 and {GTS-IS Template Vyatta - SSH:ssh.run[vrrp_status.bond0].str(BACKUP)}=0</expression>
							<recovery_mode>0</recovery_mode>
							<recovery_expression/>
							<name>VPN Peer {#VPN_PEER} Tunnel {#VPN_TUNNEL} is down (last 5 status)</name>
							<correlation_mode>0</correlation_mode>
							<correlation_tag/>
							<url/>
							<status>0</status>
							<priority>4</priority>
							<description/>
							<type>0</type>
							<manual_close>0</manual_close>
							<dependencies/>
							<tags/>
						</trigger_prototype>
					</trigger_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>VPN peer {#VPN_PEER} tunnel {#VPN_TUNNEL} - data exchanged (resets upon IKE renegotiaton)</name>
							<width>900</width>
							<height>200</height>
							<yaxismin>0.0000</yaxismin>
							<yaxismax>100.0000</yaxismax>
							<show_work_period>1</show_work_period>
							<show_triggers>1</show_triggers>
							<type>0</type>
							<show_legend>1</show_legend>
							<show_3d>0</show_3d>
							<percent_left>0.0000</percent_left>
							<percent_right>0.0000</percent_right>
							<ymin_type_1>1</ymin_type_1>
							<ymax_type_1>0</ymax_type_1>
							<ymin_item_1>0</ymin_item_1>
							<ymax_item_1>0</ymax_item_1>
							<graph_items>
								<graph_item>
									<sortorder>0</sortorder>
									<drawtype>5</drawtype>
									<color>0000DD</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>2</calc_fnc>
									<type>0</type>
									<item>
										<host>GTS-IS Template Vyatta - SSH</host>
										<key>ssh.run[vpn_tunnel_bytesin.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<drawtype>5</drawtype>
									<color>00C800</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>2</calc_fnc>
									<type>0</type>
									<item>
										<host>GTS-IS Template Vyatta - SSH</host>
										<key>ssh.run[vpn_tunnel_bytesout.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
						<graph_prototype>
							<name>VPN peer {#VPN_PEER} tunnel {#VPN_TUNNEL} - tunnel status (up/down history)</name>
							<width>900</width>
							<height>200</height>
							<yaxismin>0.0000</yaxismin>
							<yaxismax>1.5000</yaxismax>
							<show_work_period>1</show_work_period>
							<show_triggers>1</show_triggers>
							<type>0</type>
							<show_legend>1</show_legend>
							<show_3d>0</show_3d>
							<percent_left>0.0000</percent_left>
							<percent_right>0.0000</percent_right>
							<ymin_type_1>1</ymin_type_1>
							<ymax_type_1>1</ymax_type_1>
							<ymin_item_1>0</ymin_item_1>
							<ymax_item_1>0</ymax_item_1>
							<graph_items>
								<graph_item>
									<sortorder>0</sortorder>
									<drawtype>1</drawtype>
									<color>0000DD</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>2</calc_fnc>
									<type>0</type>
									<item>
										<host>GTS-IS Template Vyatta - SSH</host>
										<key>ssh.run[vpn_tunnel_status.{#VPN_PEER}:{#VPN_TUNNEL}]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<host_prototypes/>
				</discovery_rule>
			</discovery_rules>
			<httptests/>
			<macros>
				<macro>
					<macro>{$SSH_ID}</macro>
					<value/>
				</macro>
				<macro>
					<macro>{$SSH_PASSWORD}</macro>
					<value/>
				</macro>
			</macros>
			<templates/>
			<screens>
				<screen>
					<name>Vyatta system performance</name>
					<hsize>2</hsize>
					<vsize>4</vsize>
					<screen_items>
						<screen_item>
							<resourcetype>0</resourcetype>
							<width>500</width>
							<height>100</height>
							<x>0</x>
							<y>0</y>
							<colspan>1</colspan>
							<rowspan>1</rowspan>
							<elements>0</elements>
							<valign>0</valign>
							<halign>0</halign>
							<style>0</style>
							<url/>
							<dynamic>0</dynamic>
							<sort_triggers>0</sort_triggers>
							<resource>
								<name>Memory use ratio by vyatta processes Bar graph</name>
								<host>GTS-IS Template Vyatta - SSH</host>
							</resource>
							<max_columns>3</max_columns>
							<application/>
						</screen_item>
						<screen_item>
							<resourcetype>0</resourcetype>
							<width>600</width>
							<height>340</height>
							<x>1</x>
							<y>0</y>
							<colspan>1</colspan>
							<rowspan>1</rowspan>
							<elements>0</elements>
							<valign>0</valign>
							<halign>0</halign>
							<style>0</style>
							<url/>
							<dynamic>0</dynamic>
							<sort_triggers>0</sort_triggers>
							<resource>
								<name>Memory use ratio by vyatta processes Pie chart</name>
								<host>GTS-IS Template Vyatta - SSH</host>
							</resource>
							<max_columns>3</max_columns>
							<application/>
						</screen_item>
					</screen_items>
				</screen>
			</screens>
		</template>
	</templates>
	<triggers>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:vfs.file.cksum[/config/config.boot].diff(0)}&gt;0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>/config/config.boot has been changed on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>1</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.udp.listen[67].last(0)}=1</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>DHCP service is running on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>1</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:process_status[pluto].last(#2)}=1 and {GTS-IS Template Vyatta - SSH:process_status[pluto].last(#1)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>IPSec service is down on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>4</priority>
			<description>Will trigger only when LAST value is 0 (not running) AND the value before was 1 (running)</description>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.udp.listen[1701].last(#2)}=1 and {GTS-IS Template Vyatta - SSH:net.udp.listen[1701].last(#1)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>L2TP VPN service is down</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>4</priority>
			<description>Will trigger only when LAST value is 0 (not running) AND the value before was 1 (running)</description>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:proc.num[netplugd].last(0)}&lt;1</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>netplugd process is down on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>3</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:process_status[openvpn].last(#2)}=1 and {GTS-IS Template Vyatta - SSH:process_status[openvpn].last(#1)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>OpenVPN service is down on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>4</priority>
			<description>Will trigger only when LAST value is 0 (not running) AND the value before was 1 (running)</description>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.udp.listen[161].last(0)}=1</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>SNMP service is up on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>1</status>
			<priority>1</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.udp.listen[123].last(0)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>UDP NTP service is down on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>2</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:ssh.run[process_status.keepalived].last(#2)}=1 and {GTS-IS Template Vyatta - SSH:ssh.run[process_status.keepalived].last(#1)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>VRRP daemon not running</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>3</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.tcp.service[tcp,,80].last(,0)}=1</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>Web Interface is active on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>1</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.tcp.service[tcp,,3128].last(#2)}=1 and {GTS-IS Template Vyatta - SSH:net.tcp.service[tcp,,3128].last(#1)}=0</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>WebProxy service is down on {HOST.NAME}</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>3</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:net.tcp.service[tcp,,3128].last(0)}=1</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>WebProxy service is running</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>1</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{GTS-IS Template Vyatta - SSH:ssh.run[vrrp_status.bond0].change()}&gt;0 and {GTS-IS Template Vyatta - SSH:ssh.run[vrrp_status.bond0].strlen()}&gt;2</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>{HOST.NAME} has changed VRRP state!</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>2</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
	</triggers>
	<graphs>
		<graph>
			<name>Conntrack</name>
			<width>900</width>
			<height>200</height>
			<yaxismin>0.0000</yaxismin>
			<yaxismax>100.0000</yaxismax>
			<show_work_period>1</show_work_period>
			<show_triggers>1</show_triggers>
			<type>0</type>
			<show_legend>1</show_legend>
			<show_3d>0</show_3d>
			<percent_left>0.0000</percent_left>
			<percent_right>0.0000</percent_right>
			<ymin_type_1>0</ymin_type_1>
			<ymax_type_1>2</ymax_type_1>
			<ymin_item_1>0</ymin_item_1>
			<ymax_item_1>
				<host>GTS-IS Template Vyatta - SSH</host>
				<key>ssh.run[conntrack_max]</key>
			</ymax_item_1>
			<graph_items>
				<graph_item>
					<sortorder>0</sortorder>
					<drawtype>0</drawtype>
					<color>00C800</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>ssh.run[conntrack_count]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
		<graph>
			<name>Memory use ratio by vyatta processes Bar graph</name>
			<width>900</width>
			<height>200</height>
			<yaxismin>0.0000</yaxismin>
			<yaxismax>100.0000</yaxismax>
			<show_work_period>0</show_work_period>
			<show_triggers>0</show_triggers>
			<type>0</type>
			<show_legend>1</show_legend>
			<show_3d>0</show_3d>
			<percent_left>0.0000</percent_left>
			<percent_right>0.0000</percent_right>
			<ymin_type_1>0</ymin_type_1>
			<ymax_type_1>0</ymax_type_1>
			<ymin_item_1>0</ymin_item_1>
			<ymax_item_1>0</ymax_item_1>
			<graph_items>
				<graph_item>
					<sortorder>1</sortorder>
					<drawtype>0</drawtype>
					<color>00C800</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[dhcpd3]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>3</sortorder>
					<drawtype>0</drawtype>
					<color>C800C8</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[netplugd]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>4</sortorder>
					<drawtype>0</drawtype>
					<color>00C8C8</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[openvpn]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>8</sortorder>
					<drawtype>0</drawtype>
					<color>99FF99</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[snmpd]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>9</sortorder>
					<drawtype>0</drawtype>
					<color>9999FF</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[squid3]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
		<graph>
			<name>Memory use ratio by vyatta processes Pie chart</name>
			<width>600</width>
			<height>340</height>
			<yaxismin>0.0000</yaxismin>
			<yaxismax>0.0000</yaxismax>
			<show_work_period>0</show_work_period>
			<show_triggers>0</show_triggers>
			<type>2</type>
			<show_legend>1</show_legend>
			<show_3d>1</show_3d>
			<percent_left>0.0000</percent_left>
			<percent_right>0.0000</percent_right>
			<ymin_type_1>0</ymin_type_1>
			<ymax_type_1>0</ymax_type_1>
			<ymin_item_1>0</ymin_item_1>
			<ymax_item_1>0</ymax_item_1>
			<graph_items>
				<graph_item>
					<sortorder>1</sortorder>
					<drawtype>0</drawtype>
					<color>00C800</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[dhcpd3]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>3</sortorder>
					<drawtype>0</drawtype>
					<color>C800C8</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[netplugd]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>4</sortorder>
					<drawtype>0</drawtype>
					<color>00C8C8</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[openvpn]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>8</sortorder>
					<drawtype>0</drawtype>
					<color>99FF99</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[snmpd]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>9</sortorder>
					<drawtype>0</drawtype>
					<color>9999FF</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>GTS-IS Template Vyatta - SSH</host>
						<key>proc.mem[squid3]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
	</graphs>
	<value_maps>
		<value_map>
			<name>Host availability</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>Not available</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>Available</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>Unknown</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>Service state</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>Down</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>Up</newvalue>
				</mapping>
				<mapping>
					<value>3</value>
					<newvalue>Error</newvalue>
				</mapping>
			</mappings>
		</value_map>
	</value_maps>
</zabbix_export>
