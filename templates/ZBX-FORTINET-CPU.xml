<?xml version="1.0" ?>
<zabbix_export>
	<version>3.4</version>
	<date>2017-01-01T01:01:01Z</date>
	<groups>
		<group>
			<name>ZBX-FORTINET-TEMPLATES</name>
		</group>
	</groups>
	<templates>
		<template>
			<template>ZBX-FORTINET-CPU</template>
			<name>ZBX-FORTINET-CPU</name>
			<description/>
			<groups>
				<group>
					<name>ZBX-FORTINET-TEMPLATES</name>
				</group>
			</groups>
			<applications>
				<application>
					<name>CPU</name>
				</application>
			</applications>
			<items>
				<item>
					<name>Number of Processors</name>
					<type>4</type>
					<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
					<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.1.0</snmp_oid>
					<key>fgProcessorCount</key>
					<delay>1h</delay>
					<history>1w</history>
					<trends>365d</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units/>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<params/>
					<ipmi_sensor/>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>CPU</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
					<preprocessing/>
					<jmx_endpoint/>
					<master_item/>
				</item>
				<item>
					<name>System CPU Usage</name>
					<type>4</type>
					<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
					<snmp_oid>.1.3.6.1.4.1.12356.101.4.1.3.0</snmp_oid>
					<key>fgSysCpuUsage</key>
					<delay>5m</delay>
					<history>1w</history>
					<trends>365d</trends>
					<status>0</status>
					<value_type>3</value_type>
					<allowed_hosts/>
					<units>%</units>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<params/>
					<ipmi_sensor/>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<description/>
					<inventory_link>0</inventory_link>
					<applications>
						<application>
							<name>CPU</name>
						</application>
					</applications>
					<valuemap/>
					<logtimefmt/>
					<preprocessing/>
					<jmx_endpoint/>
					<master_item/>
				</item>
			</items>
			<discovery_rules>
				<discovery_rule>
					<name>fgProcessor</name>
					<type>4</type>
					<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
					<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.2.1.1</snmp_oid>
					<key>fgProcessorEntIndex</key>
					<delay>5m</delay>
					<status>0</status>
					<allowed_hosts/>
					<snmpv3_contextname/>
					<snmpv3_securityname/>
					<snmpv3_securitylevel>0</snmpv3_securitylevel>
					<snmpv3_authprotocol>0</snmpv3_authprotocol>
					<snmpv3_authpassphrase/>
					<snmpv3_privprotocol>0</snmpv3_privprotocol>
					<snmpv3_privpassphrase/>
					<params/>
					<ipmi_sensor/>
					<authtype>0</authtype>
					<username/>
					<password/>
					<publickey/>
					<privatekey/>
					<port/>
					<filter>
						<evaltype>0</evaltype>
						<formula/>
						<conditions/>
					</filter>
					<lifetime>30d</lifetime>
					<description/>
					<item_prototypes>
						<item_prototype>
							<name>Average Usage of System Process over 1min per Processor#$1</name>
							<type>4</type>
							<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
							<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.2.1.10.{#SNMPINDEX}</snmp_oid>
							<key>fgProcessorSysUsage.[&quot;{#SNMPINDEX}&quot;]</key>
							<delay>5m</delay>
							<history>1w</history>
							<trends>365d</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>%</units>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<params/>
							<ipmi_sensor/>
							<authtype>0</authtype>
							<username/>
							<password/>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>CPU</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<preprocessing/>
							<jmx_endpoint/>
							<application_prototypes/>
							<master_item_prototype/>
						</item_prototype>
						<item_prototype>
							<name>Average Usage over 1min per Processor#$1</name>
							<type>4</type>
							<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
							<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.2.1.2.{#SNMPINDEX}</snmp_oid>
							<key>fgProcessorUsage.[&quot;{#SNMPINDEX}&quot;]</key>
							<delay>5m</delay>
							<history>1w</history>
							<trends>365d</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>%</units>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<params/>
							<ipmi_sensor/>
							<authtype>0</authtype>
							<username/>
							<password/>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>CPU</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<preprocessing/>
							<jmx_endpoint/>
							<application_prototypes/>
							<master_item_prototype/>
						</item_prototype>
						<item_prototype>
							<name>Average Usage over 5sec per Processor#$1</name>
							<type>4</type>
							<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
							<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.2.1.3.{#SNMPINDEX}</snmp_oid>
							<key>fgProcessorUsage5sec.[&quot;{#SNMPINDEX}&quot;]</key>
							<delay>5m</delay>
							<history>1w</history>
							<trends>365d</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>%</units>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<params/>
							<ipmi_sensor/>
							<authtype>0</authtype>
							<username/>
							<password/>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>CPU</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<preprocessing/>
							<jmx_endpoint/>
							<application_prototypes/>
							<master_item_prototype/>
						</item_prototype>
						<item_prototype>
							<name>Average Usage of User Process over 1min per Processor#$1</name>
							<type>4</type>
							<snmp_community>{$SNMP_COMMUNITY}</snmp_community>
							<snmp_oid>.1.3.6.1.4.1.12356.101.4.4.2.1.9.{#SNMPINDEX}</snmp_oid>
							<key>fgProcessorUserUsage.[&quot;{#SNMPINDEX}&quot;]</key>
							<delay>5m</delay>
							<history>1w</history>
							<trends>365d</trends>
							<status>0</status>
							<value_type>3</value_type>
							<allowed_hosts/>
							<units>%</units>
							<snmpv3_contextname/>
							<snmpv3_securityname/>
							<snmpv3_securitylevel>0</snmpv3_securitylevel>
							<snmpv3_authprotocol>0</snmpv3_authprotocol>
							<snmpv3_authpassphrase/>
							<snmpv3_privprotocol>0</snmpv3_privprotocol>
							<snmpv3_privpassphrase/>
							<params/>
							<ipmi_sensor/>
							<authtype>0</authtype>
							<username/>
							<password/>
							<publickey/>
							<privatekey/>
							<port/>
							<description/>
							<inventory_link>0</inventory_link>
							<applications>
								<application>
									<name>CPU</name>
								</application>
							</applications>
							<valuemap/>
							<logtimefmt/>
							<preprocessing/>
							<jmx_endpoint/>
							<application_prototypes/>
							<master_item_prototype/>
						</item_prototype>
					</item_prototypes>
					<trigger_prototypes>
						<trigger_prototype>
							<expression>{ZBX-FORTINET-CPU:fgProcessorUsage5sec.[&quot;{#SNMPINDEX}&quot;].last(0)}&gt;80</expression>
							<recovery_mode>0</recovery_mode>
							<recovery_expression/>
							<name>Average Usage over 5sec per Processor#{#SNMPINDEX} exceeded 80%</name>
							<correlation_mode>0</correlation_mode>
							<correlation_tag/>
							<url/>
							<status>0</status>
							<priority>4</priority>
							<description/>
							<type>0</type>
							<manual_close>0</manual_close>
							<dependencies/>
							<tags/>
						</trigger_prototype>
					</trigger_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>CPU Usage per Processor#{#SNMPVALUE}</name>
							<width>900</width>
							<height>200</height>
							<yaxismin>0.0000</yaxismin>
							<yaxismax>100.0000</yaxismax>
							<show_work_period>1</show_work_period>
							<show_triggers>1</show_triggers>
							<type>0</type>
							<show_legend>1</show_legend>
							<show_3d>0</show_3d>
							<percent_left>0.0000</percent_left>
							<percent_right>0.0000</percent_right>
							<ymin_type_1>1</ymin_type_1>
							<ymax_type_1>1</ymax_type_1>
							<ymin_item_1>0</ymin_item_1>
							<ymax_item_1>0</ymax_item_1>
							<graph_items>
								<graph_item>
									<sortorder>0</sortorder>
									<drawtype>2</drawtype>
									<color>00C800</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>7</calc_fnc>
									<type>0</type>
									<item>
										<host>ZBX-FORTINET-CPU</host>
										<key>fgProcessorUsage5sec.[&quot;{#SNMPINDEX}&quot;]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<drawtype>0</drawtype>
									<color>0000C8</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>7</calc_fnc>
									<type>0</type>
									<item>
										<host>ZBX-FORTINET-CPU</host>
										<key>fgProcessorUsage.[&quot;{#SNMPINDEX}&quot;]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>2</sortorder>
									<drawtype>4</drawtype>
									<color>C800C8</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>7</calc_fnc>
									<type>0</type>
									<item>
										<host>ZBX-FORTINET-CPU</host>
										<key>fgProcessorUserUsage.[&quot;{#SNMPINDEX}&quot;]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>3</sortorder>
									<drawtype>4</drawtype>
									<color>C80000</color>
									<yaxisside>0</yaxisside>
									<calc_fnc>7</calc_fnc>
									<type>0</type>
									<item>
										<host>ZBX-FORTINET-CPU</host>
										<key>fgProcessorSysUsage.[&quot;{#SNMPINDEX}&quot;]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<host_prototypes/>
					<jmx_endpoint/>
				</discovery_rule>
			</discovery_rules>
			<httptests/>
			<macros/>
			<templates/>
			<screens/>
		</template>
	</templates>
	<triggers>
		<trigger>
			<expression>{ZBX-FORTINET-CPU:fgSysCpuUsage.avg(600)}&gt;50 and {ZBX-FORTINET-CPU:fgSysCpuUsage.avg(600)}&lt;60</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>CPU usage exceeded 50%</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>2</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{ZBX-FORTINET-CPU:fgSysCpuUsage.avg(600)}&gt;60 and {ZBX-FORTINET-CPU:fgSysCpuUsage.avg(600)}&lt;80</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>CPU usage exceeded 60%</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>3</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
		<trigger>
			<expression>{ZBX-FORTINET-CPU:fgSysCpuUsage.avg(600)}&gt;80</expression>
			<recovery_mode>0</recovery_mode>
			<recovery_expression/>
			<name>CPU usage exceeded 80%</name>
			<correlation_mode>0</correlation_mode>
			<correlation_tag/>
			<url/>
			<status>0</status>
			<priority>3</priority>
			<description/>
			<type>0</type>
			<manual_close>0</manual_close>
			<dependencies/>
			<tags/>
		</trigger>
	</triggers>
	<graphs>
		<graph>
			<name>CPU Usage</name>
			<width>900</width>
			<height>200</height>
			<yaxismin>0.0000</yaxismin>
			<yaxismax>100.0000</yaxismax>
			<show_work_period>1</show_work_period>
			<show_triggers>1</show_triggers>
			<type>0</type>
			<show_legend>1</show_legend>
			<show_3d>0</show_3d>
			<percent_left>0.0000</percent_left>
			<percent_right>0.0000</percent_right>
			<ymin_type_1>1</ymin_type_1>
			<ymax_type_1>1</ymax_type_1>
			<ymin_item_1>0</ymin_item_1>
			<ymax_item_1>0</ymax_item_1>
			<graph_items>
				<graph_item>
					<sortorder>0</sortorder>
					<drawtype>2</drawtype>
					<color>EACC00</color>
					<yaxisside>0</yaxisside>
					<calc_fnc>2</calc_fnc>
					<type>0</type>
					<item>
						<host>ZBX-FORTINET-CPU</host>
						<key>fgSysCpuUsage</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
	</graphs>
</zabbix_export>
